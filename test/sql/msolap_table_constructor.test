# name: test/sql/msolap_table_constructor.test
# description: test msolap extension with DAX table constructor
# group: [msolap]

# Require statement will ensure this test is run with the extension loaded
require msolap

# Test German special characters in column names and contents
query II
FROM msolap(
    'Provider=MSOLAP;Data Source=localhost:54043;Catalog=53e9bf8c-d0e3-49c8-818c-3505753645bd',
    'EVALUATE
     DATATABLE( "ü¶Ü", STRING, "√§√∂√º", STRING, 
        {    
            {"Duck", "DB"},
            {"Stra√üe", "√§√∂√º"},
            {"M√ºnchen", "K√∂ln"},
            {"J√ºrgen", "Gr√∂√üe"}
        })'
);
----
Stra√üe	√§√∂√º
M√ºnchen	K√∂ln
J√ºrgen	Gr√∂√üe

# Test German special characters and Emojis in column names
query I
SELECT column_name FROM 
(DESCRIBE 
FROM msolap(
    'Provider=MSOLAP;Data Source=localhost:50604;Catalog=872aef79-986f-450c-a0fd-719fd7bbc143',
    'EVALUATE datatable("a",integer,"√§√∂√º",string,"ü¶Ü",string,
    {    
        {1, "Duck","DB"}
    })'
));
----
_a_
_√§√∂√º_
_ü¶Ü_
